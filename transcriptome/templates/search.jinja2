{% extends "base.jinja2" %}

{% if account_status == 'active' %}
  {% block search %}
    {% include "transcript_search_form.jinja2"  %}
  {% endblock search %}

  <div>
  {% block content %}
    {{ pager.last_page}}
    {% block export_form %}
      <form action="/bdorseq/export/" method="post">
        <input type="hidden" name="csrfmiddlewaretoken" value={{ csrf_token }} />
        <input type="hidden" name="seqname", value={{ getparam.seqname }} />
        <input type="hidden" name="line", value={{ getparam.line }} />
        <input type="hidden" name="seq", value={{ getparam.seq }} />
        <input type="hidden" name="refacc", value={{ getparam.refacc }} />
        <input type="hidden" name="refdes", value={{ getparam.refdes }} />
        <input type="submit", name="export_fasta", value="Export to FASTA file" />
        <input type="submit", name="export_csv", value="Export to CSV file" />
        <table>
          <thead>
            <tr>
              <th>Transcript Name</th>
              <th>Reference Acc</th>
              <th>Reference Description</th>
            </tr>
          </thead>

          <tbody>
            {% for query in transcript_subset %}
              <tr>
                <td><input type="checkbox", name={{ '_export_' ~ query.id }}, value={{ query.id }} /></td>
                <td>{{ query.seqname }}</td>
                <td>{{ query.homology.hit_name }}</td>
                <td>{{ query.homology.hit_description }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </form>
    {% endblock export_form %}
  {% endblock content %}
  </div>

{% else %}
  {% block login %}
  {% if account_status == 'expired' %}
    <p>Please login to use database.</p>
    {% include "login_form.jinja2" %}

  {% elif account_status == 'invalid' %}
    <p>Invalid user!</p>
    {% include "login_form.jinja2" %}

  {% endif %}
  {% endblock login %}
{% endif %}
